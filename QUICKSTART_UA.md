# üöÄ –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –ø–æ –∑–∞–ø—É—Å–∫—É –ø—Ä–æ–µ–∫—Ç—É Data Platform

–î–∞–Ω–∏–π –ø—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª—ñ–∑—É—î Medallion Architecture (Bronze -> Silver -> Gold) –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º AWS S3, Glue, Airflow —Ç–∞ Redshift.

## üìã –ü–æ—Ä—è–¥–æ–∫ –∑–∞–ø—É—Å–∫—É –ø–∞–π–ø–ª–∞–π–Ω—ñ–≤ –≤ Airflow

–î–ª—è –ø–æ–≤–Ω–æ–≥–æ —Ü–∏–∫–ª—É –æ–±—Ä–æ–±–∫–∏ –¥–∞–Ω–∏—Ö –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ DAG-–∏ —É –Ω–∞—Å—Ç—É–ø–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É:

### 1. –†—ñ–≤–µ–Ω—å Bronze (–°–∏—Ä—ñ –¥–∞–Ω—ñ)
–ó–∞–ø—É—Å—Ç—ñ—Ç—å –Ω–∞—Å—Ç—É–ø–Ω—ñ DAG-–∏ –¥–ª—è –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ —Å–∏—Ä–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç—É (CSV/JSON) —É —Ñ–æ—Ä–º–∞—Ç Parquet:
*   `process_customers` ‚Äî –¥–∞–Ω—ñ –∫–ª—ñ—î–Ω—Ç—ñ–≤.
*   `process_user_profiles` ‚Äî –ø—Ä–æ—Ñ—ñ–ª—ñ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤.
*   `process_sales` ‚Äî –¥–∞–Ω—ñ –ø—Ä–æ –ø—Ä–æ–¥–∞–∂—ñ.

### 2. –†—ñ–≤–µ–Ω—å Silver (–û—á–∏—â–µ–Ω–Ω—è)
–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü—ñ—è —Ç–∞ —Ç–∏–ø—ñ–∑–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —É –º–µ–∂–∞—Ö —Ç–∏—Ö —Å–∞–º–∏—Ö DAG-—ñ–≤ –Ω–∞ –¥—Ä—É–≥–æ–º—É –∫—Ä–æ—Ü—ñ. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è, —â–æ –≤—Å—ñ –≤–æ–Ω–∏ –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—è —É—Å–ø—ñ—à–Ω–æ.

### 3. –†—ñ–≤–µ–Ω—å Gold (–ó–±–∞–≥–∞—á–µ–Ω–Ω—è —Ç–∞ –ê–Ω–∞–ª—ñ—Ç–∏–∫–∞)
–¶–µ –æ—Å–Ω–æ–≤–Ω–∏–π –µ—Ç–∞–ø, —è–∫–∏–π –æ–±'—î–¥–Ω—É—î –¥–∞–Ω—ñ —Ç–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î —ó—Ö —É Redshift:
*   –ó–∞–ø—É—Å—Ç—ñ—Ç—å DAG `enrich_user_profiles`.
    *   **Task 1**: –ù–∞–ª–∞—à—Ç–æ–≤—É—î –∫–∞—Ç–∞–ª–æ–≥ Glue.
    *   **Task 2**: –û–±'—î–¥–Ω—É—î –∫–ª—ñ—î–Ω—Ç—ñ–≤ —Ç–∞ –ø—Ä–æ—Ñ—ñ–ª—ñ (–¥–æ–¥–∞—î –≤—ñ–∫, —à—Ç–∞—Ç–∏, birth_date).
    *   **Task 3**: –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î —Ñ—ñ–Ω–∞–ª—å–Ω—É —Ç–∞–±–ª–∏—Ü—é `gold.user_profiles_enriched` —É Redshift.

---

## üìä –ê–Ω–∞–ª—ñ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ (Redshift)

–©–æ–± –æ—Ç—Ä–∏–º–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ —Ñ—ñ–Ω–∞–ª—å–Ω–µ –∑–∞–ø–∏—Ç–∞–Ω–Ω—è –ø—Ä–æ–µ–∫—Ç—É, –≤–∏–∫–æ–Ω–∞–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω–∏–π SQL-–∑–∞–ø–∏—Ç —É –∫–æ–Ω—Å–æ–ª—ñ Redshift:

```sql
-- –¢–æ–ø —à—Ç–∞—Ç –∑–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—é –ø–æ–∫—É–ø–æ–∫ –¢–í –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ 20-30 —Ä–æ–∫—ñ–≤ (1-10 –≤–µ—Ä–µ—Å–Ω—è 2022)
SELECT 
    u.state,
    COUNT(*) as tv_purchases
FROM 
    gold.sales s
JOIN 
    gold.user_profiles_enriched u ON s.client_id = u.client_id
WHERE 
    s.product_name = 'TV'
    AND EXTRACT(MONTH FROM s.purchase_date) = 9
    AND EXTRACT(DAY FROM s.purchase_date) BETWEEN 1 AND 10
    AND DATEDIFF(year, u.birth_date, s.purchase_date) BETWEEN 20 AND 30
GROUP BY 
    u.state
ORDER BY 
    tv_purchases DESC
LIMIT 1;
```

## üõ† –¢–µ—Ö–Ω—ñ—á–Ω—ñ –¥–µ—Ç–∞–ª—ñ
*   **Data Lake**: `s3://dp-feb15-data-lake-157671019517/`
*   **Database**: `dev`
*   **Redshift Workgroup**: `dp-feb15-workgroup`
